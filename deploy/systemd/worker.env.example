# Worker process (systemd)
ENVIRONMENT=production

# Run workers without binding an HTTP port (safe for multi-instance)
WORKER_ENABLED=true
API_ENABLED=false

# Strongly recommended on workers (run migrations/seed on your main server only)
INIT_SCHEMA=false
SEED_NEO4J=false

# Worker concurrency / retry tuning
WORKER_CONCURRENCY=4
WORKER_JOB_TIMEOUT=10m
WORKER_MAX_RETRIES=3
WORKER_RETRY_DELAY=30s
WORKER_SHUTDOWN_TIMEOUT=30s

# Scheduler leader election (ensures only ONE worker runs scheduler)
SCHEDULER_LOCK_KEY=scheduler:leader
SCHEDULER_LOCK_TTL=30s
SCHEDULER_LOCK_RENEW=10s

# Central PostgreSQL (REQUIRED)
DB_HOST=
DB_PORT=5432
DB_USER=flights
DB_PASSWORD=
DB_NAME=flights
# If connecting over Tailscale to a non-TLS Postgres, keep SSL disabled (Tailscale encrypts the transport).
DB_SSLMODE=disable
DB_REQUIRE_SSL=false

# Central Redis (REQUIRED)
REDIS_HOST=
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_QUEUE_GROUP=flights_workers
REDIS_QUEUE_STREAM_PREFIX=flights
REDIS_QUEUE_BLOCK_TIMEOUT=5s
REDIS_QUEUE_VISIBILITY_TIMEOUT=2m

# Neo4j (REQUIRED for PriceGraph / graph storage)
# Using Tailscale IP for secure private network access
NEO4J_ENABLED=true
NEO4J_URI=bolt://100.87.196.33:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=

# Flight search tuning
EXCLUDED_AIRLINES=NK,G4,F9,SY,XP,MX
TOP_N_DEALS=3

# Logging
# LOG_LEVEL: debug | info | warn | error
LOG_LEVEL=info
# LOG_FORMAT: json | text
LOG_FORMAT=json
