<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flight Search</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <style>
      body {
        background-color: #f8f9fa;
      }

      .card {
        border-radius: 0.75rem;
        box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      }

      .card-header {
        border-top-left-radius: 0.75rem;
        border-top-right-radius: 0.75rem;
      }

      .flight-card {
        border: 1px solid rgba(15, 23, 42, 0.1);
        border-radius: 0.75rem;
        padding: 1.25rem;
        margin-bottom: 1rem;
        background: #ffffff;
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.05);
      }

      .chart-container {
        position: relative;
        height: 320px;
      }

      #advancedBtn {
        font-weight: 500;
      }

      #advancedOptions {
        background: rgba(13, 110, 253, 0.04);
        border-radius: 0.75rem;
        padding: 1.5rem;
        border: 1px dashed rgba(13, 110, 253, 0.3);
      }

      #loadingIndicator {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <header class="mb-4">
        <h1 class="display-6 fw-semibold text-primary mb-2">Search Flights</h1>
        <p class="text-muted mb-0">
          Compare fares, review price history, and jump straight to Google
          Flights.
        </p>
      </header>

      <div class="card mb-4">
        <div class="card-body">
          <form id="searchForm" novalidate>
            <div class="row g-3">
              <div class="col-md-6">
                <label for="origin" class="form-label">Origin</label>
                <input
                  type="text"
                  id="origin"
                  class="form-control"
                  placeholder="e.g. JFK, New York"
                  required
                />
              </div>
              <div class="col-md-6">
                <label for="destination" class="form-label">Destination</label>
                <input
                  type="text"
                  id="destination"
                  class="form-control"
                  placeholder="e.g. LAX, Los Angeles"
                  required
                />
              </div>
              <div class="col-md-4">
                <label for="departure_date" class="form-label"
                  >Departure Date</label
                >
                <input
                  type="text"
                  id="departure_date"
                  class="form-control"
                  placeholder="Select date"
                  required
                />
              </div>
              <div class="col-md-4">
                <label for="return_date" class="form-label">Return Date</label>
                <input
                  type="text"
                  id="return_date"
                  class="form-control"
                  placeholder="Select date (optional)"
                />
              </div>
              <div class="col-md-4">
                <label for="trip_type" class="form-label">Trip Type</label>
                <select id="trip_type" class="form-select">
                  <option value="round_trip" selected>Round trip</option>
                  <option value="one_way">One way</option>
                </select>
              </div>
            </div>

            <div class="d-flex flex-wrap align-items-center gap-3 mt-3">
              <button
                type="button"
                class="btn btn-link text-decoration-none px-0"
                id="advancedBtn"
              >
                <i class="bi bi-sliders me-2"></i>Advanced options
              </button>
              <div class="text-muted small">
                Adjust cabin class, stops, passengers, and currency.
              </div>
            </div>

            <div
              id="advancedOptions"
              class="row g-3 mt-1"
              style="display: none"
            >
              <div class="col-md-3">
                <label for="class" class="form-label">Cabin Class</label>
                <select id="class" class="form-select">
                  <option value="economy" selected>Economy</option>
                  <option value="premium_economy">Premium Economy</option>
                  <option value="business">Business</option>
                  <option value="first">First</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="stops" class="form-label">Stops</label>
                <select id="stops" class="form-select">
                  <option value="any" selected>Any</option>
                  <option value="non_stop">Non-stop</option>
                  <option value="1">1 stop</option>
                  <option value="2">2+ stops</option>
                </select>
              </div>
              <div class="col-md-2">
                <label for="adults" class="form-label">Adults</label>
                <input
                  type="number"
                  id="adults"
                  class="form-control"
                  value="1"
                  min="1"
                  required
                />
              </div>
              <div class="col-md-2">
                <label for="children" class="form-label">Children</label>
                <input
                  type="number"
                  id="children"
                  class="form-control"
                  value="0"
                  min="0"
                />
              </div>
              <div class="col-md-2">
                <label for="infantsLap" class="form-label">Infants (lap)</label>
                <input
                  type="number"
                  id="infantsLap"
                  class="form-control"
                  value="0"
                  min="0"
                />
              </div>
              <div class="col-md-2">
                <label for="infantsSeat" class="form-label"
                  >Infants (seat)</label
                >
                <input
                  type="number"
                  id="infantsSeat"
                  class="form-control"
                  value="0"
                  min="0"
                />
              </div>
              <div class="col-md-2">
                <label for="currency" class="form-label">Currency</label>
                <input
                  type="text"
                  id="currency"
                  class="form-control text-uppercase"
                  value="USD"
                  maxlength="3"
                />
              </div>
            </div>

            <div class="d-flex flex-wrap align-items-center gap-3 mt-4">
              <button type="submit" class="btn btn-primary px-4">
                <i class="bi bi-search me-2"></i>Search Flights
              </button>
              <div
                id="loadingIndicator"
                class="d-flex align-items-center text-muted"
              >
                <div
                  class="spinner-border spinner-border-sm me-2"
                  role="status"
                  aria-hidden="true"
                ></div>
                Searching fares…
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="card mb-4" id="priceGraphCard" style="display: none">
        <div class="card-header bg-light">
          <i class="bi bi-graph-up-arrow me-2 text-primary"></i>
          Price History
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas
              id="priceGraph"
              role="img"
              aria-label="Flight price history"
            ></canvas>
          </div>
        </div>
      </div>

      <div class="card" id="resultsCard" style="display: none">
        <div
          class="card-header bg-white d-flex flex-wrap justify-content-between align-items-center gap-3"
        >
          <div>
            <h2 class="h5 mb-0">Flight Results</h2>
            <p class="text-muted mb-0 small">
              We’ll sort the best fares for you—choose another ordering if you
              prefer.
            </p>
          </div>
          <div class="d-flex align-items-center gap-2">
            <label for="sortResults" class="form-label mb-0 text-muted small"
              >Sort by</label
            >
            <select id="sortResults" class="form-select form-select-sm">
              <option value="price">Lowest price</option>
              <option value="duration">Shortest duration</option>
              <option value="departure">Earliest departure</option>
            </select>
          </div>
        </div>
        <div class="card-body">
          <div id="flightResults"></div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"
      crossorigin="anonymous"
    ></script>
    <script src="/search/search.js"></script>
  </body>
</html>
