# =============================================================================
# Worker Node Configuration
# =============================================================================
# Copy this file to .env.worker and fill in your values
# Deploy to multiple servers to distribute the scraping load
# =============================================================================

# -----------------------------------------------------------------------------
# Worker Identification
# -----------------------------------------------------------------------------
# Give each worker a unique ID for debugging/monitoring
WORKER_ID=worker-us-east-1

# -----------------------------------------------------------------------------
# Central Database Connection (REQUIRED)
# -----------------------------------------------------------------------------
# All workers connect to the SAME PostgreSQL database
# Use your main server's external IP or hostname
DB_HOST=your-main-server.example.com
DB_PORT=5432
DB_USER=flights
DB_PASSWORD=your-secure-password
DB_NAME=flights
DB_SSLMODE=require
DB_REQUIRE_SSL=true

# -----------------------------------------------------------------------------
# Central Redis Connection (REQUIRED)
# -----------------------------------------------------------------------------
# All workers share the SAME Redis queue
# Use your main server's external IP or hostname
REDIS_HOST=your-main-server.example.com
REDIS_PORT=6379
REDIS_PASSWORD=your-redis-password

# Queue settings (should match across all workers)
REDIS_QUEUE_GROUP=flights_workers
REDIS_QUEUE_STREAM_PREFIX=flights
REDIS_QUEUE_BLOCK_TIMEOUT=5s
REDIS_QUEUE_VISIBILITY_TIMEOUT=2m

# -----------------------------------------------------------------------------
# Worker Pool Settings
# -----------------------------------------------------------------------------
# Number of concurrent goroutines per worker container
# More concurrency = more parallel Google Flights requests
# Start with 4, increase if you have headroom
WORKER_CONCURRENCY=4

# How long to wait for a job to complete before timing out
WORKER_JOB_TIMEOUT=10m

# Retry settings
WORKER_MAX_RETRIES=3
WORKER_RETRY_DELAY=30s

# -----------------------------------------------------------------------------
# Neo4j (Optional)
# -----------------------------------------------------------------------------
# If you want route graph analysis, connect to your central Neo4j
NEO4J_URI=bolt://your-main-server.example.com:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your-neo4j-password

# -----------------------------------------------------------------------------
# Push Notifications (Optional)
# -----------------------------------------------------------------------------
# Get alerts when sweeps complete or errors occur
NTFY_ENABLED=false
NTFY_SERVER_URL=https://ntfy.sh
NTFY_TOPIC=your-flights-topic

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=json
ENVIRONMENT=production
